# Практична робота №6

**Виконали:** ІП-з31 Семен Прохода, Арсен Потеряйко

**Тема:** Забезпечення відмовостійкості та надійності системи.

**Мета:** Навчитись передбачати потенційні проблеми системи на етапі формування технічних вимог, та приймати рішення, щодо їх коректної обробки.

## Завдання:

### 1. Скласти список ключових потенційних відмов системи.

- Доступ робітник до адмінських або менеджерських функцій.

- Надсилання дубліката заявки (один робітник надсилає декілька заяв).

- Відсутні або некоректні дані в заявці.

- Адмін намагається підтвердити вже прийняту/відхилену заявку.

### 2. Вибрати по 1 проблемі на студента, та описати 2-3 варіанти рішення цих проблем

- Проблема: Розсинхронізація з базою даних підприємства

  Опис:  
  Система інтегрується з базою даних підприємства для отримання актуальної інформації про користувачів, ролі та інші дані. У випадку, коли база даних підприємства тимчасово недоступна або сталася помилка під час оновлення, локальні дані можуть втратити актуальність. Це може призвести до логічних помилок, некоректного відображення інформації, дублювання або некоректної обробки заявок.

  Варіанти вирішення:
  1. Перевірка актуальності перед дією:  
     Перед виконанням критичних дій (наприклад, обробка заявки, оновлення прав доступу) слід здійснювати запит до бази даних підприємства, щоб переконатися в актуальності інформації.
  2. Автоматична періодична синхронізація:  
     Реалізувати механізм регулярного оновлення даних з бази підприємства, наприклад, кожні кілька хвилин. У разі виявлення помилки синхронізації слід створювати запис у журналі системи та інформувати відповідального адміністратора.
  3. Відображення статусу синхронізації:  
     На адміністративній панелі показувати індикатор успішності останньої синхронізації. Якщо виникла помилка — попереджати користувача про можливу втрату актуальності даних.

- Проблема: Відмова мікросервісу сповіщень

  Опис:  
  У системі використовується окремий мікросервіс для надсилання сповіщень (електронна пошта, push-сповіщення тощо). У випадку його тимчасової недоступності або збоїв у роботі, повідомлення про важливі події (наприклад, підтвердження заявки або зміна ролі) не надсилаються. Це може призвести до дезінформації користувачів або адміністративних ризиків.

  Варіанти вирішення:
  1. Черга повідомлень з повторними спробами:  
     Використовувати проміжну чергу для зберігання сповіщень, які не вдалося доставити. При відновленні сервісу — повторити спробу надсилання.
  2. Моніторинг і алерти:  
     Реалізувати моніторинг стану мікросервісу. У разі відмови — надсилати автоматичне повідомлення адміністраторам через альтернативний канал (наприклад, Telegram).
  3. Візуальна індикація в системі:  
     Якщо мікросервіс недоступний — показувати відповідне повідомлення в інтерфейсі, щоб попередити користувачів про можливу затримку або відсутність сповіщення.

---

### 3. Обрати рішення проблеми, та обґрунтувати з точки зору бізнесу (врахувати пріоритети, час виконання, ресурси, вартість і т.д.)

- Проблема: Розсинхронізація з базою даних підприємства

  Рішення:  
  Найефективнішим підходом є впровадження механізму автоматичної фонової синхронізації з базою даних підприємства. Це дозволяє регулярно оновлювати локальні копії даних без залучення користувачів.

  Поведінка системи у разі відсутності зв’язку з базою підприємства:
  - Якщо останнє оновлення було успішним (наприклад, менше 10 хв тому), система може працювати в режимі зчитування з локального кешу.
  - Якщо дані не оновлювались довше встановленого порогу (наприклад, 15 хвилин), система:
    - Блокує виконання критичних дій, пов’язаних із ролями або правами (підвищення, зміна доступу тощо).
    - Показує повідомлення про відсутність актуальних даних: “Оновлення інформації з бази підприємства тимчасово недоступне. Спробуйте пізніше.”
    - Дозволяє перегляд старих даних лише в режимі "читання", з відповідним попередженням про можливу неактуальність.

  Бізнес-обґрунтування:
  - Такий підхід дозволяє уникнути помилок, пов’язаних з неактуальними ролями, користувачами або правами доступу.
  - Він дає користувачам зрозуміле повідомлення про ситуацію та не створює відчуття “зламаної” системи.
  - Фонове оновлення просте у реалізації, не потребує значних витрат, і може масштабуватись у майбутньому для підтримки великих обсягів користувачів.


- Проблема: Відмова мікросервісу сповіщень

  Рішення:  
  З бізнесової точки зору найбільш доцільним є впровадження черги повідомлень з можливістю повторних спроб надсилання. Це рішення дозволяє гарантувати доставку сповіщень навіть у разі тимчасової недоступності сервісу. Такий механізм має високу надійність, не є складним у реалізації, і значно підвищує довіру користувачів до системи. Також воно знижує ризики втрати важливої інформації та зменшує навантаження на службу підтримки.



### 4. Описати діаграму послідовностей (sequence diagram) для проблем.

![OpenApi!](./Pics/Lab6.png)

### 5. Вкажіть, які патерни вокористовуються.

1. Retry 
   - Використовується у вирішенні проблеми з відмовою мікросервісу сповіщень.  
   - Реалізується шляхом додавання черги з повідомленнями, які повторно надсилаються при відновленні сервісу.

2. Cache
   - Застосовується у рішенні щодо розсинхронізації з базою даних підприємства.  
   - Дані тимчасово зберігаються локально для читання, навіть якщо центральна БД тимчасово недоступна.

3. Role-Based Access Control
   - Застосовується для обмеження дій користувачів у системі.  
   - Дає змогу відокремити доступ до функцій для ролей: робітник, менеджер, адміністратор.